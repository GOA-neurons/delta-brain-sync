name: Sync to Hugging Face
on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
          lfs: true

      - name: Push Code to HF
        run: |
          git push --force https://TELEFOXX:${{ secrets.HF_TOKEN }}@huggingface.co/spaces/TELEFOXX/GOA main

      - name: Sync Secrets to HF
        run: |
          curl -X POST https://huggingface.co/api/spaces/TELEFOXX/GOA/variables \
            -H "Authorization: Bearer ${{ secrets.HF_TOKEN }}" \
            -H "Content-Type: application/json" \
            -d '{
              "variables": [
                {"key": "DATABASE_URL", "value": "${{ secrets.DATABASE_URL }}"},
                {"key": "SUPABASE_URL", "value": "${{ secrets.SUPABASE_URL }}"},
                {"key": "SUPABASE_KEY", "value": "${{ secrets.SUPABASE_KEY }}"},
                {"key": "GROQ_API_KEY", "value": "${{ secrets.GROQ_API_KEY }}"},
                {"key": "FIREBASE_CONFIG", "value": "${{ secrets.FIREBASE_CONFIG }}"}
              ]
            }'
            
