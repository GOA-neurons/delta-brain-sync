name: Sync to Hugging Face
on:
  push:
    branches: [main] # á€™á€„á€ºá€¸á€›á€²á€· Branch á€€ master á€–á€¼á€…á€ºá€”á€±á€›á€„á€º master á€œá€­á€¯á€· á€•á€¼á€±á€¬á€„á€ºá€¸á€•á€±á€¸á€•á€«

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
          lfs: true

      # áá‹ ğŸ”± PUSH CODE TO HF (ULTIMATE FORCE-FEED METHOD)
      - name: Push Code to HF
        run: |
          # Git Identity á€€á€­á€¯ CI á€•á€á€ºá€á€”á€ºá€¸á€€á€»á€„á€ºá€¡á€á€½á€€á€º á€á€á€ºá€™á€¾á€á€ºá€™á€šá€º
          git config --global user.email "commander@goa.com"
          git config --global user.name "TELEFOXX"
          
          # Git á€€á€­á€¯ á€˜á€¬á€™á€±á€¸á€á€½á€„á€·á€ºá€™á€¾ á€™á€•á€±á€¸á€¡á€±á€¬á€„á€º Credential Helper á€€á€­á€¯ á€•á€­á€á€ºá€™á€šá€º
          git config --global credential.helper ""
          
          # ğŸ”± á€’á€«á€€ á€¡á€“á€­á€€ á€‚á€­á€á€ºá€†á€¯á€¶á€¸á€”á€Šá€ºá€¸á€œá€™á€ºá€¸á€•á€² - Username á€”á€±á€›á€¬á€™á€¾á€¬ 'token' á€œá€­á€¯á€· á€á€¯á€¶á€¸á€•á€¼á€®á€¸ Token á€€á€­á€¯ á€á€­á€¯á€€á€ºá€›á€­á€¯á€€á€ºá€‘á€­á€¯á€¸á€‘á€Šá€·á€ºá€™á€šá€º
          # Format: https://token:YOUR_TOKEN@huggingface.co/spaces/USER/SPACE
          git push --force https://token:${{ secrets.HF_TOKEN }}@huggingface.co/spaces/TELEFOXX/GOA main

      # á‚á‹ ğŸ”± SYNC SECRETS TO HF (API METHOD)
      - name: Sync Secrets to HF
        run: |
          curl -X POST https://huggingface.co/api/spaces/TELEFOXX/GOA/variables \
            -H "Authorization: Bearer ${{ secrets.HF_TOKEN }}" \
            -H "Content-Type: application/json" \
            -d '{
              "variables": [
                {"key": "DATABASE_URL", "value": "${{ secrets.DATABASE_URL }}"},
                {"key": "SUPABASE_URL", "value": "${{ secrets.SUPABASE_URL }}"},
                {"key": "SUPABASE_KEY", "value": "${{ secrets.SUPABASE_KEY }}"},
                {"key": "GROQ_API_KEY", "value": "${{ secrets.GROQ_API_KEY }}"},
                {"key": "FIREBASE_CONFIG", "value": "${{ secrets.FIREBASE_CONFIG }}"}
              ]
            }'
            
