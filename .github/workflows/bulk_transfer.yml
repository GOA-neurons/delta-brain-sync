name: Bulk Node Transfer
on:
  workflow_dispatch: # Manual Run ·Äú·ÄØ·Äï·Ä∫·Äñ·Ä≠·ÄØ·Ä∑·Ä°·Äê·ÄΩ·ÄÄ·Ä∫

jobs:
  transfer:
    runs-on: ubuntu-latest
    steps:
      - name: Supreme Transfer Execution
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GH_TOKEN }} # PAT Token ·ÄÄ·Ä≠·ÄØ Org Secret ·Äë·Ä≤·Äô·Äæ·Ä¨ ·Äë·Ää·Ä∑·Ä∫·Äë·Ä¨·Ä∏·Äõ·Äï·Ä´·Äô·Äö·Ä∫
          script: |
            const TARGET_ORG = "GOA-Neural-Swarm"; // ‚úÖ Screenshot ·Ä°·Äõ Org ·Äî·Ä¨·Äô·Ää·Ä∫·Ä°·Äô·Äæ·Äî·Ä∫·Äû·Ä≠·ÄØ·Ä∑ ·Äï·Äº·ÄÑ·Ä∫·ÄÜ·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏
            const USERNAME = context.repo.owner;

            const repos = await github.paginate(github.rest.repos.listForAuthenticatedUser, {
              visibility: 'public',
              per_page: 100
            });

            // "swarm-node-" ·Äî·Ä≤·Ä∑·ÄÖ·Äï·Äº·ÄÆ·Ä∏ Target Org ·Äë·Ä≤ ·Äô·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä±·Ä∏·Äê·Ä≤·Ä∑ repo ·Äê·ÄΩ·Ä±·ÄÄ·Ä≠·ÄØ·Äï·Ä≤ ·Äõ·ÄΩ·Ä±·Ä∏·Äô·Äö·Ä∫
            const swarmNodes = repos.filter(repo => 
              repo.name.startsWith('swarm-node-') && 
              repo.owner.login !== TARGET_ORG
            );

            console.log(`üì° Found ${swarmNodes.length} nodes to transfer...`);

            for (const repo of swarmNodes) {
              try {
                console.log(`üöÄ Transferring ${repo.name} to ${TARGET_ORG}...`);
                await github.rest.repos.transfer({
                  owner: repo.owner.login,
                  repo: repo.name,
                  new_owner: TARGET_ORG,
                });
                console.log(`‚úÖ Success: ${repo.name}`);
                
                // GitHub Rate limit ·Äô·Äô·Ä≠·Ä°·Ä±·Ä¨·ÄÑ·Ä∫ ·ÅÅ ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫ ·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äô·Äö·Ä∫
                await new Promise(r => setTimeout(r, 1000)); 
              } catch (err) {
                console.log(`‚ùå Failed ${repo.name}: ${err.message}`);
              }
            }
